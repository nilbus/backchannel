<div class="column">
  <% if @posts.any? %>
    <% @posts.each do |post| %>
      <div class="post">
        <div class="user">
          <%=h post.user.try :name %>
        </div>
        <div class="content">
          <%=h post.content %>
          <% if logged_in? %>
            <div class="cheer">
              <span class="cheer-counter <%= 'cheered' if post.cheered_by?(current_user) %>"><%= post.cheers.count %></span>
              <%= link_to_function image_tag('heart.svg'), 'cheer(this)', :title => 'cheer this post' %>
            </div>
          <% end %>
        </div>
        <%= link_to_function 'Reply', 'reply(this)' unless !logged_in? or @searching %>
        <div class="new_post_fields" style="display: none;">
          <% form_for Post.new do |f| %>
            <%= f.text_field :content %>
            <%= f.hidden_field :parent_id, :value => post.id %>
          <% end %>
        </div>
        <%= link_to 'Delete', post_path(post), :method => :delete, :confirm => "Delete post?" if current_user.try :admin %>
      </div>
      <div class="replies">
        <% unless @searching %>
          <% post.replies.each do |reply| %>
            <div class="post reply">
              <div class="user">
                <%=h reply.user.try :name %>
              </div>
              <div class="content">
                <%=h reply.content %>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>
    <% end %>
    <%= link_to_function 'Reply', 'reply($(this))', :id => 'add_post', :class => 'reply_link' if logged_in? %>
    <div class="new_post_fields" style="display: none;">
      <% form_for Post.new do |f| %>
        <%= f.text_field :content %>
      <% end %>
    </div>
  <% else %>
    <div class="search">
      <strong>No Posts</strong>
      <%= link_to_function 'Reply', 'reply($(this))', :id => 'add_post', :class => 'reply_link' if logged_in? %>
      <div class="new_post_fields" style="display: none;">
        <% form_for Post.new do |f| %>
          <%= f.text_field :content %>
        <% end %>
      </div>
    </div>
  <% end %>
</div>

<div class="column">
  <div class="search">
    <strong>Search</strong><br>
    <% form_tag search_posts_path, :method => :get do |f| %>
      <%= text_field_tag :search %>
    <% end %>
  </div>
</div>
